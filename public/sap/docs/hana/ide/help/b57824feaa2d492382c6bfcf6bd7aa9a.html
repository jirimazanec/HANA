<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="cache-control" content="max-age=0"/>
<meta http-equiv="cache-control" content="no-cache"/>
<meta http-equiv="expires" content="0"/>
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
<meta http-equiv="pragma" content="no-cache"/>
<meta name="abstract" content="Changes to the definition of a CDS artifact result in changes to the corresponding catalog object. The resultant changes to the catalog object are made according to strict rules."/>
<meta name="description" content="Changes to the definition of a CDS artifact result in changes to the corresponding catalog object. The resultant changes to the catalog object are made according to strict rules."/>

<link rel="stylesheet" type="text/css" href="css/documentation.css?x=661655640883305"/>
<title>Modifications to CDS Artifacts</title>
<!--[if lte IE 7]><style>
      .codeblock{
          overflow:visible;
      }</style><![endif]-->
<script type="text/javascript"><!-- 
        var loops = 10; 
        function GetLoio() { return "loiob57824feaa2d492382c6bfcf6bd7aa9a";
        } 
        function Sync() { if (parent.SAP_TOC && parent.SAP_TOC.gMenu) {parent.SAP_TOC.gMenu.SelectEntry(GetLoio()); } 
        else if (parent != self && loops-- > 0) { window.setTimeout( "Sync()",500 ); } } 
        Sync(); 

 function hijackLink (elem) { if(elem.href.indexOf('#')
          > 0 ){ var hr = elem.href.substr(0,
          elem.href.indexOf('#')); var anc = elem.href.substr(elem.href.indexOf('#'),
          elem.href.length); var dum = Math.random(); parent.window.location = hr + "?x=" + dum +
          anc; } } //-->
</script>
</head>
<body class="sap_bluecrystal" id="loiob57824feaa2d492382c6bfcf6bd7aa9a">
<div id="wrapper"><div id="container">

	<h1 class="title topictitle1">Modifications to CDS Artifacts</h1>

	
	<div class="body conbody"><p class="shortdesc">Changes to the definition of a CDS artifact result in changes to the corresponding
		catalog object. The resultant changes to the catalog object are made according to strict
		rules.</p>

		<p class="p">Reactivating a CDS document which contains changes to the original artifacts results in changes
			to the corresponding objects in the catalog. Before making change to the design-time
			definition of a CDS artifact, it is very important to understand what the consequences
			of the planned changes will be in the generated catalog objects. </p>

		<ul class="ul" id="loiob57824feaa2d492382c6bfcf6bd7aa9a__ul_eq1_qx3_hn">
			<li class="li"><a class="xref" href="default.html?b57824feaa2d492382c6bfcf6bd7aa9a.html#loiob57824feaa2d492382c6bfcf6bd7aa9a__section_mq5_hcv_5p" target="_top">Removing
					an artifact from a CDS document</a></li>

			<li class="li"><a class="xref" href="default.html?b57824feaa2d492382c6bfcf6bd7aa9a.html#loiob57824feaa2d492382c6bfcf6bd7aa9a__section_wxz_hcv_5p" target="_top">Changing
					the definition of an artifact in a CDS document</a></li>

			<li class="li"><a class="xref" href="default.html?b57824feaa2d492382c6bfcf6bd7aa9a.html#loiob57824feaa2d492382c6bfcf6bd7aa9a__section_b12_3cv_5p" target="_top">Modifying a catalog object generated by CDS</a></li>

			<li class="li"><a class="xref" href="default.html?b57824feaa2d492382c6bfcf6bd7aa9a.html#loiob57824feaa2d492382c6bfcf6bd7aa9a__section_z1g_tcv_5p" target="_top">Transporting a DU that contains modified CDS documents</a></li>

		</ul>

		<div class="section" id="loiob57824feaa2d492382c6bfcf6bd7aa9a__section_mq5_hcv_5p"><div class="section_title">Removing an Artifact from a CDS Document</div><div type="Removing an Artifact from a CDS Document">
			
			<div class="p">If a CDS design-time artifact (for example, a table or a view) defined in an old
				version of a CDS document is no longer present in the new version, the corresponding
				runtime object is dropped from the catalog. <div class="note note"><span class="notetitle">Note</span> Renaming a CDS artifact results in
					the deletion of the artifact with the old name (with all the corresponding
					consequences) and the creation of a new CDS artifact with the new
				name.</div>
</div>

		</div></div>

		<div class="section" id="loiob57824feaa2d492382c6bfcf6bd7aa9a__section_wxz_hcv_5p"><div class="section_title">Changing the Definition of an Artifact in a CDS Document</div><div type="Changing the Definition of an Artifact in a CDS Document">
			
			<p class="p">If a CDS design-time artifact is present in both the old and the new version of a CDS
				document, a check is performed to establish what, if any, changes have occurred.
				This applies to changes made either directly to a CDS artifact or indirectly, for
				example, as a result of a change to a dependent artifact. If changes have been made
				to the CDS document, changes are implemented in the corresponding catalog objects
				according to the following rules:</p>

			<ul class="ul" id="loiob57824feaa2d492382c6bfcf6bd7aa9a__ul_ck1_4z3_hn">
				<li class="li">Views <p class="p">Views in the <span class="ph pname">SAP HANA</span> catalog are dropped and recreated according to
						the new design-time specification for the artifact in the CDS
					document.</p>
</li>

				<li class="li">Element types <p class="p">Changing the type of an element according to the implicit conversion rules
						described in the <span class="ph pname">SAP HANA</span> SQL documentation (<cite class="cite">SAP HANA
							SQL Data Type Conversion</cite>). Note: For some type conversions the
						activation will succeed only if the data in the corresponding DB table is
						valid for the target type (for example the conversion of String to Integer
						will succeed only if the corresponding DB table column contains only numbers
						that match the Integer type) </p>
</li>

				<li class="li">Element modifier: <samp class="ph codeph">Null</samp>/<samp class="ph codeph">NOT NULL</samp><p class="p">Adding,
						removing or changing element modifiers <span class="q">“<samp class="ph codeph">Null</samp>”</span> and
								<span class="q">“<samp class="ph codeph">not null</samp>”</span> to make an element nullable ot not
						nullable respectively can lead to problems when activating the resulting
						artifact; the activation will succeed only if the data in the database table
						corresponding to the CDS entity matches the new modifier. For example, you
						cannot make an element not nullable, if in the corresponding column in the
						database table some null values exist for which there is no default value
						defined. </p>
</li>

				<li class="li">Element modifier: Default Value<p class="p">If the default value modifier is removed, this
						has no effect on the existing data in the corresponding database table, and
						no default value will be used for any subsequently inserted record. If the
						default value is modified or newly added, the change will be applicable to
						all subsequent inserts in the corresponding database table. In addition, if
						the element is not nullable (irrespective of whether it was defined
						previously as such or within the same activation), the existing null values
						in the corresponding table will be replaced with the new default
					value.</p>
</li>

				<li class="li">Element modifier: Primary Key<div class="p">You can add an element to (or remove it from)
						the primary key by adding or removing the <span class="q">“<samp class="ph codeph">key</samp>”</span>
							modifier.<div class="note note"><span class="notetitle">Note</span>  Adding the <span class="q">“<samp class="ph codeph">key</samp>”</span> modifier to an
							element will also make the column in the corresponding table <samp class="ph codeph">not
								nullable</samp>. If column in the corresponding database table
							contains <samp class="ph codeph">null</samp> values and there is no default value
							defined for the element, the activation of the modified CDS document
							will fail. </div>
</div>
</li>

				<li class="li">Column or row store (<samp class="ph codeph">@Catalog.tableType</samp>)<p class="p">It is possible to
						change the <samp class="ph codeph">Catalog.tableType</samp> annotation that defines the
						table type, for example, to transform a table from the column store
							(<samp class="ph codeph">#COLUMN</samp>) to row store (<samp class="ph codeph">#ROW</samp>), and
						vice versa. </p>
</li>

				<li class="li">Index types (<samp class="ph codeph">@Catalog.index</samp>)<p class="p">Is is possible to change the
								<span class="q">“<samp class="ph codeph">Catalog.index</samp>”</span> annotation, as long as the
						modified index is valid for the corresponding CDS entity. </p>

				</li>

			</ul>

			<p class="p">For changes to individual elements of a CDS entity, for example, column definitions,
				the same logic applies as for complete artifacts in a CDS document. </p>

			<ul class="ul" id="loiob57824feaa2d492382c6bfcf6bd7aa9a__ul_tgt_4bj_hn">
				<li class="li">Since the elements of a CDS entity are identified by their name, changing the
					order of the elements in the entity definition will have no effect; the order of
					the columns in the generated catalog table object remains unchanged.</li>

				<li class="li">Renaming an element in a CDS entity definition is not recognized; the rename
					operation results in the deletion of the renamed element and the creation of a
					new one. </li>

				<li class="li">If a new element is added to a CDS entity definition, the order of the columns in the table
					generated in the catalog after the change cannot be guaranteed.</li>

			</ul>

			<div class="note note"><span class="notetitle">Note</span> If an existing CDS entity definition is changed, the order of the columns in the
				generated database tables may be different from the order of the corresponding
				elements in the CDS entity definition.</div>

			<p class="p">In the following example of a simple CDS document, the context
					<samp class="ph codeph">OuterCtx</samp> contains a CDS entity <samp class="ph codeph">Entity1</samp> and the
				nested context <samp class="ph codeph">InnerCtx</samp>, which contains the CDS entity definition
					<samp class="ph codeph">Entity2</samp>.</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">namespace pack;
@Schema: 'MYSCHEMA'

context OuterCtx
{
  entity Entity1
  {
    key a : Integer;
        b : String(20);
  };
  context InnerCtx
  {
    entity Entity2
    {
      key x : Integer;
          y : String(10);
          z : LocalDate;
    };
  };
};</pre></div>

			<p class="p">To understand the effect of the changes made to this simple CDS document in the
				following example, it is necessary to see the changes not only from the perspective
				of the developer who makes the changes but also the compiler which needs to
				interpret them. </p>

			<p class="p">From the developer's perspective, the CDS entity <samp class="ph codeph">Entity1</samp> has been
				moved from context <samp class="ph codeph">OuterCtx</samp> to <samp class="ph codeph">InnerCtx</samp>. From the
				compiler's perspective, however, the entity <samp class="ph codeph">pack::OuterCtx.Entity1</samp>
				has disappeared and, as a result, will be deleted (and the corresponding generated
				table with all its content dropped), and a new entity named
					<samp class="ph codeph">pack::OuterCtx.InnerCtx.Entity1</samp> has been defined.</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">namespace pack; 
@Schema: 'MYSCHEMA'

context OuterCtx
{
  context InnerCtx
  {
    entity Entity1
    {
      key a : Integer;
          b : String(20);
    };

    entity Entity2
    {
      key x : Integer;
          q : String(10); 
          z : LocalDate;
    };
  };
};</pre></div>

			<p class="p">Similarly, renaming the element <samp class="ph codeph">y: String;</samp> to <samp class="ph codeph">q:
					String;</samp> in <samp class="ph codeph">Entity2</samp> results in the deletion of column
					<samp class="ph codeph">y</samp> and the creation of a new column <samp class="ph codeph">q</samp> in the
				generated catalog object. As a consequence, the content of column <samp class="ph codeph">y</samp>
				is lost.</p>

		</div></div>

		<div class="section" id="loiob57824feaa2d492382c6bfcf6bd7aa9a__section_b12_3cv_5p"><div class="section_title">Modifying a Catalog Object Generated from CDS</div><div type="Modifying a Catalog Object Generated from CDS">
			
			<p class="p">CDS does not support modifications to catalog objects generated from CDS documents. You must
				never modify an <span class="ph pname">SAP HANA</span> catalog object (in particular a table) that
				has been generated from a CDS document. The next time you activate the CDS document
				that contains the original CDS object definition and the corresponding catalog
				objects are generated, all modifications made to the catalog object are lost or
				activation might even fail due to inconsistencies. </p>

		</div></div>

		<div class="section" id="loiob57824feaa2d492382c6bfcf6bd7aa9a__section_z1g_tcv_5p"><div class="section_title">Transporting a DU that Contains Modified CDS Documents</div><div type="Transporting a DU that Contains Modified CDS Documents">
			
			<p class="p">If the definition of a CDS entity has already been transported to another system, do
				not enforce activation of any illegal changes to this entity, for example, by means
				of an intermediate deletion.</p>

			<p class="p">Restrictions apply to changes that can be made to a CDS entity if the entity has been
				activated and a corresponding catalog object exists. If changes to a CDS entity on
				the source system produce an error during activation of the CDS document, for
				example, because you changed an element type in a CDS entity from
					<samp class="ph codeph">Binary</samp> to <samp class="ph codeph">LocalDate</samp>, you could theoretically
				delete the original CDS entity and then create a new CDS entity with the same name
				as the original entity but with the changed data type. However, if this change is
				transported to another system, where the old version of the entity already exists,
				the import will fail, because the information that the entity has been deleted and
				recreated is not available either on the target system or in the delivery unit.</p>

		</div></div>

	</div>

	<div class="related-links"> 
<div class="relinfo"><div class="relinfotitle ">Related Information</div>
<div><a class="link" href="default.html?a83fe9b8de1c4f4bbee3eea675851a04.html" target="_top" title="Mapping table for SAP HANA (hdbtable) and Core Data Services (CDS) types.">SAP HANA to CDS Data-Type Mapping</a></div>
<div><a class="link" href="http://help.sap.com/saphelp_hanaplatform/helpdata/en/20/a1569875191014b507cf392724b7eb/content.htm#loio20a1569875191014b507cf392724b7eb___csql_data_types_1sql_data_types_introduction_conversion" target="_blank" alt="http://help.sap.com/saphelp_hanaplatform/helpdata/en/20/a1569875191014b507cf392724b7eb/content.htm#loio20a1569875191014b507cf392724b7eb___csql_data_types_1sql_data_types_introduction_conversion" title="http://help.sap.com/saphelp_hanaplatform/helpdata/en/20/a1569875191014b507cf392724b7eb/content.htm#loio20a1569875191014b507cf392724b7eb___csql_data_types_1sql_data_types_introduction_conversion">SAP HANA SQL Data Type Conversion</a></div>
</div>
</div>
</div></div><div class="footer" id="custom-footer">
	<div id="custom-footerSpacer"><hr width="350px" align="left"/></div>
	<a class="copyright" href="copyright.html" target="_blank">Copyright</a><span class="separator"> | </span><a class="disclaimer" href="disclaimer.html" target="_blank">Important Disclaimers and Legal Information</a>
</div>

<SCRIPT LANGUAGE="JavaScript"><!--
 var page_title="Modifications to CDS Artifacts";

        if (page_title !='' &&
        parent.document.title != null) {
 parent.document.title =
          page_title;
 } 
 var
        anchor = document.getElementById(location.hash.substring(+1)); if (typeof (anchor)
        !='undefined' && anchor !=null){
        var top = anchor.getBoundingClientRect().top; } 
//-->
</SCRIPT>
</body>
</html>