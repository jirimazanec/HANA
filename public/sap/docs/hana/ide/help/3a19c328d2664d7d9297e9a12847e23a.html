<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="cache-control" content="max-age=0"/>
<meta http-equiv="cache-control" content="no-cache"/>
<meta http-equiv="expires" content="0"/>
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
<meta http-equiv="pragma" content="no-cache"/>
<meta name="abstract" content="Use trace files and other tools to fix problems with test operations."/>
<meta name="description" content="Use trace files and other tools to fix problems with test operations."/>

<link rel="stylesheet" type="text/css" href="css/documentation.css?x=801322119850119"/>
<title>XSUnit Troubleshooting Solutions</title>
<!--[if lte IE 7]><style>
      .codeblock{
          overflow:visible;
      }</style><![endif]-->
<script type="text/javascript"><!-- 
        var loops = 10; 
        function GetLoio() { return "loio3a19c328d2664d7d9297e9a12847e23a";
        } 
        function Sync() { if (parent.SAP_TOC && parent.SAP_TOC.gMenu) {parent.SAP_TOC.gMenu.SelectEntry(GetLoio()); } 
        else if (parent != self && loops-- > 0) { window.setTimeout( "Sync()",500 ); } } 
        Sync(); 

 function hijackLink (elem) { if(elem.href.indexOf('#')
          > 0 ){ var hr = elem.href.substr(0,
          elem.href.indexOf('#')); var anc = elem.href.substr(elem.href.indexOf('#'),
          elem.href.length); var dum = Math.random(); parent.window.location = hr + "?x=" + dum +
          anc; } } //-->
</script>
</head>
<body class="sap_bluecrystal" id="loio3a19c328d2664d7d9297e9a12847e23a">
<div id="wrapper"><div id="container">

	<h1 class="title topictitle1">XSUnit Troubleshooting Solutions</h1>

	
	<div class="body refbody"><p class="shortdesc">Use trace files and other tools to fix problems with test operations.</p>

		<div class="section">
			<p class="p">The Mockstar test-isolation tools write helpful information in the <span class="ph pname">SAP HANA</span>
				trace files. You can adapt the trace level, for example, to <samp class="ph codeph">debug</samp>
				to ensure the right amount and type of information is written during the test run.
				Note that you need the corresponding administration role to be able to change the
				trace-level settings in <span class="ph pname">SAP HANA</span>. The trace files are written in the
				trace component <span class="ph filepath">xsa:sap.hana.testtools</span> (truncated to
				“xsa:sap.hana.tes” in the trace files). </p>

			<div class="note tip"><span class="tiptitle">Tip</span> As an alternative to reading the trace files directly, you can also use the SQL
				console to select data from the table <samp class="ph codeph">M_MERGED_TRACES</samp>.</div>

			<p class="p">This section contains information about the problems that developers frequently encounter
				during test runs:</p>

			<ul class="ul" id="loio3a19c328d2664d7d9297e9a12847e23a__ul_m1l_5rk_rp">
				<li class="li"><a class="xref" href="default.html?3a19c328d2664d7d9297e9a12847e23a.html#loio3a19c328d2664d7d9297e9a12847e23a__section_bky_yvk_rp" target="_top">SAP HANA Test Tools Version</a></li>

				<li class="li"><a class="xref" href="default.html?3a19c328d2664d7d9297e9a12847e23a.html#loio3a19c328d2664d7d9297e9a12847e23a__section_yj3_prk_rp" target="_top">The Library is Not Part of an Application</a></li>

				<li class="li"><a class="xref" href="default.html?3a19c328d2664d7d9297e9a12847e23a.html#loio3a19c328d2664d7d9297e9a12847e23a__section_y2s_btk_rp" target="_top">Error for Cloned OData Service</a></li>

				<li class="li"><a class="xref" href="default.html?3a19c328d2664d7d9297e9a12847e23a.html#loio3a19c328d2664d7d9297e9a12847e23a__section_fqz_5tk_rp" target="_top">Duplicate Entries When Inserting Test Data</a></li>

				<li class="li"><a class="xref" href="default.html?3a19c328d2664d7d9297e9a12847e23a.html#loio3a19c328d2664d7d9297e9a12847e23a__section_nf1_xtk_rp" target="_top">Test Table Already Exists</a></li>

				<li class="li"><a class="xref" href="default.html?3a19c328d2664d7d9297e9a12847e23a.html#loio3a19c328d2664d7d9297e9a12847e23a__section_ajw_jvk_rp" target="_top">Test Model Activation Fails</a></li>

				<li class="li"><a class="xref" href="default.html?3a19c328d2664d7d9297e9a12847e23a.html#loio3a19c328d2664d7d9297e9a12847e23a__section_bbg_mvk_rp" target="_top">No Entries Returned From Copied Test Model</a></li>

				<li class="li"><a class="xref" href="default.html?3a19c328d2664d7d9297e9a12847e23a.html#loio3a19c328d2664d7d9297e9a12847e23a__section_jqy_4vk_rp" target="_top">No Test Data Inserted into Test Table</a></li>

				<li class="li"><a class="xref" href="default.html?3a19c328d2664d7d9297e9a12847e23a.html#loio3a19c328d2664d7d9297e9a12847e23a__section_ac2_rvk_rp" target="_top">TestRunner Tool Times Out</a></li>

				<li class="li"><a class="xref" href="default.html?3a19c328d2664d7d9297e9a12847e23a.html#loio3a19c328d2664d7d9297e9a12847e23a__section_kmk_svk_rp" target="_top">Test Model Creation is Aborted</a></li>

				<li class="li"><a class="xref" href="default.html?3a19c328d2664d7d9297e9a12847e23a.html#loio3a19c328d2664d7d9297e9a12847e23a__section_tvk_vvk_rp" target="_top">Database Connections in XSUnit Test</a></li>

			</ul>

		</div>

		<div class="section" id="loio3a19c328d2664d7d9297e9a12847e23a__section_bky_yvk_rp"><div class="section_title">SAP HANA Test Tools Version</div><div type="SAP HANA Test Tools Version">
			
			<p class="p">Which version of the SAP HANA test tools suite is installed?</p>

			<ol class="ol" id="loio3a19c328d2664d7d9297e9a12847e23a__ol_q5l_bwk_rp">
				<li class="li">Start SAP HANA studio</li>

				<li class="li">Open the <span class="ph uicontrol">SAP HANA Modeler</span> perspective.</li>

				<li class="li">In the <span class="ph uicontrol">Quick Launch</span> window, choose <span class="ph uicontrol">Delivery
						Units...</span></li>

				<li class="li">Choose <span class="ph uicontrol">HANA_TEST_TOOLS</span>.</li>

			</ol>

		</div></div>

		<div class="section" id="loio3a19c328d2664d7d9297e9a12847e23a__section_yj3_prk_rp"><div class="section_title">Import Error: The Library is Not Part of an Application</div><div type="Import Error: The Library is Not Part of an Application">
			
			<p class="p">If the test runner tool shows the following error:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">import: the library is not part of an application</pre></div>

			<p class="p">The JavaScript library you want to test can only be loaded when there is an
				application descriptor (<span class="ph filepath">.xsapp</span> file) defined within the package
				hierarchy. The application descriptor is the core file that you use to describe an
				application's framework within <span class="ph pname">SAP HANA</span> XS. If your tests are not
				part of your application package hierarchy, it is  recommended you to create an
					<span class="ph filepath">.xsapp</span> file in the context of the XS Project that contains
				the tests.</p>

		</div></div>

		<div class="section" id="loio3a19c328d2664d7d9297e9a12847e23a__section_y2s_btk_rp"><div class="section_title">Error for Cloned OData Service</div><div type="Error for Cloned OData Service"><p class="p">The
				following error message is displayed when testing access to an OData service in
					<span class="ph pname">SAP HANA</span>
			XS:</p>
<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">404 - Not found: Error for cloned OData Service (.xsodata)</pre></div>
Try
			the following solutions:<ol class="ol" id="loio3a19c328d2664d7d9297e9a12847e23a__ol_vzc_jsk_rp">
				<li class="li">Try to access the generated service directly in a separate Web browser. </li>

				<li class="li">Check whether the file (<span class="ph filepath">xsodata</span> service definition) exists,
					has been activated in the <span class="ph pname">SAP HANA</span> repository, and is in the
					expected target folder. </li>

				<li class="li">Ensure that the target folder or one of its parent folders contains the
					following activated artifacts: <ul class="ul" id="loio3a19c328d2664d7d9297e9a12847e23a__ul_hyt_qsk_rp">
						<li class="li"><span class="ph filepath">.xsapp</span> file<p class="p">Application descriptor file required
								by an <span class="ph pname">SAP HANA</span> XS application</p>
</li>

						<li class="li"><span class="ph filepath">.xsaccess</span> file<p class="p">Application access file which
								enables access to an <span class="ph pname">SAP HANA</span> XS application</p>
</li>

					</ul>
</li>

			</ol>
</div></div>

		<div class="section" id="loio3a19c328d2664d7d9297e9a12847e23a__section_fqz_5tk_rp"><div class="section_title">Duplicate Entries When Inserting Test Data</div><div type="Duplicate Entries When Inserting Test Data">
			
			<p class="p">If you encounter problems concerning duplicate entries when running tests, try the
				following solutions:</p>

			<ol class="ol" id="loio3a19c328d2664d7d9297e9a12847e23a__ol_kzd_gtk_rp">
				<li class="li">When inserting records into a productive table, ensure that no
						<samp class="ph codeph">jasmine.dbConnection.commit()</samp> call occurs during test
					execution.</li>

				<li class="li">When inserting records into a test table, ensure that the table entries are
					deleted (dropped) before they are (re)created.</li>

			</ol>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">var tableUtils = new TableUtils(jasmine.dbConnection);
tableUtils.clearTableInUserSchema(invoicesTestTable);
</pre></div>

		</div></div>

		<div class="section" id="loio3a19c328d2664d7d9297e9a12847e23a__section_nf1_xtk_rp"><div class="section_title">Test Table Already Exists</div><div type="Test Table Already Exists">
			
			<p class="p">You encounter an error message that explains that a test table cannot be created
				during the test because the table already exists. You must ensure that the specified
				table is deleted before the test tries to create it during the test run.</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">var sqlExecutor = new SqlExecutor(jasmine.dbConnection);

var createTableString = 'CREATE COLUMN TABLE ' + &lt;table name&gt; + '...' );

sqlExecutor.execSingleIgnoreFailing('drop table ' + &lt;table name&gt; );
sqlExecutor.execSingle(createTableString );</pre></div>

			<p class="p">You can also use the functions provided by the table utilitites library, which
				enables you to ensure that the table is dropped at the right time:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">var tableUtils = new TableUtils(jasmine.dbConnection);
testTable = tableUtils.copyIntoUserSchema(originSchema, originTable);</pre></div>

		</div></div>

		<div class="section" id="loio3a19c328d2664d7d9297e9a12847e23a__section_ajw_jvk_rp"><div class="section_title">Test Model Activation Fails</div><div type="Test Model Activation Fails">
			
			<p class="p">Your test produces an error relating to a failed activation:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">Error: Repository: Activation failed for at least one object [...]
identifier is too long:[...]
Maximum length is 127: ...</pre></div>

			<p class="p">the name of the model is too long (inlcuding the package name). You can reduce the
				name by setting the <samp class="ph codeph">TruncOptions</samp> option as shown in the following
				code snippet:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">var mockstar = $.sap.hana.testtools.mockstar;
testView = mockstar.apiFacade.createTestModel(originalModel, 
           targetPackage, dependencySubstitutions, mockstar.TruncOptions.FULL);</pre></div>

			<div class="note tip"><span class="tiptitle">Tip</span> Its a good idea to analyze the created model before it is
				activated.</div>

			<p class="p">To generate a detailed and structured error log, in the <span class="ph pname">SAP HANA</span>
				<span class="ph uicontrol">Systems</span> view in the <span class="ph pname">SAP HANA</span> studio and locate
				the test package and activate it manually.</p>

		</div></div>

		<div class="section" id="loio3a19c328d2664d7d9297e9a12847e23a__section_bbg_mvk_rp"><div class="section_title">No Entries Returned From Copied Test Model</div><div type="No Entries Returned From Copied Test Model">
			
			<p class="p"/>

			<ol class="ol" id="loio3a19c328d2664d7d9297e9a12847e23a__ol_uhp_hhl_rp">
				<li class="li">Open the generated test model. <p class="p">The generated model is located in a package
						with the name
								<span class="ph filepath">tmp.unittest.<var class="keyword varname">&lt;userName&gt;</var>.<var class="keyword varname">&lt;originalPackage&gt;</var>.</span>
						If you have configured the <samp class="ph codeph">createTestModel()</samp> function with
						the parameter <samp class="ph codeph">mockstar.TruncOptions.FULL</samp>, the package name
						is <span class="ph filepath">tmp.unittest.<var class="keyword varname">&lt;userName&gt;</var></span>. </p>
</li>

				<li class="li">Ensure that the dependencies have been replaced as expected. <p class="p">To see if the
						tables are filled correctly by the test, see <a class="xref" href="default.html?3a19c328d2664d7d9297e9a12847e23a.html#loio3a19c328d2664d7d9297e9a12847e23a__section_jqy_4vk_rp" target="_top">No Test Data Inserted into Test Table</a>. </p>
</li>

				<li class="li">Check the test view itself. <p class="p">If the tested view returns no data, but data are
						expected, check if the data are removed by a filter during extraction from
						the underlying data source. </p>
</li>

			</ol>

		</div></div>

		<div class="section" id="loio3a19c328d2664d7d9297e9a12847e23a__section_jqy_4vk_rp"><div class="section_title">No Test Data Inserted into Test Table</div><div type="No Test Data Inserted into Test Table">
			
			<p class="p">To test whether a test inserts data as expected into the created test table, implement a
					<samp class="ph codeph">jasmine.dbConnection.commit( )</samp> connection to ensure that the
				data created during the test is stored persistently. Without the
					<samp class="ph codeph">jasmine.dbConnection.commit( )</samp>, the test data is not
				persistent; the test deletes all test data when the database session is closed.
				Start the test again using the TestRunner tool. When the test completes, the test
				table should contain test data. </p>

		</div></div>

		<div class="section" id="loio3a19c328d2664d7d9297e9a12847e23a__section_ac2_rvk_rp"><div class="section_title">TestRunner Tool Times Out</div><div type="TestRunner Tool Times Out">
			
			<p class="p">The detault timeout setting for the <span class="ph filepath">TestRunner</span> tool is ten (10) minutes.
				If your test run for longer than ten minutes and cause a timeout, try splitting the
				test into smaller and shorter elements. If this is no possible, try running the test
				in three phases:</p>

			<ol class="ol" id="loio3a19c328d2664d7d9297e9a12847e23a__ol_yyp_vjl_rp">
				<li class="li">Prepare the test
							run.<p class="p"><samp class="ph codeph">/sap/hana/testtools/unit/jasminexs/PrepareTestRun.xsjs</samp></p>
<p class="p">This
						generates a new test-run ID; no test runs are executed.</p>
<ul class="ul" id="loio3a19c328d2664d7d9297e9a12847e23a__ul_whr_hkl_rp">
						<li class="li">Response:<p class="p">Returns the new test-run ID. If you request the answer in
								HTML format and provide all required parameters for the
									<samp class="ph codeph">TestRunner</samp> tool, you receive the appropriate
								links you can use in the following steps (run the test and fetch the
								results).</p>
</li>

						<li class="li">Parameters:<p class="p"><samp class="ph codeph">format</samp> (optional; default =
										<span class="q">“<samp class="ph codeph">html</samp>”</span>) </p>
<p class="p">Set this parameter to
								receive the test-run ID in the desired format. You can use any of
								the formats supported by the <samp class="ph codeph">TestRunner</samp>
								<span class="keyword parmname">format</span> parameter.</p>
</li>

					</ul>
</li>

				<li class="li">Run the
							tests.<p class="p"><samp class="ph codeph">/sap/hana/testtools/unit/jasminexs/TestRunner.xsjs</samp></p>
<p class="p">This
						step is almost identical to the usual test execution with the addition of
						parameter <samp class="ph codeph">runid</samp>.</p>
<ul class="ul" id="loio3a19c328d2664d7d9297e9a12847e23a__ul_l1x_fll_rp">
						<li class="li">Response:<p class="p"> If the tests finish within the configured time frame, you
								receive the test results as expected. If the test are too long,a
								timeout occurs.</p>
</li>

						<li class="li">Parameters:<p class="p"><samp class="ph codeph">runid</samp>. Required for this kind of (manual)
								execution: This is the test-run ID generated in the previous step.
							</p>
</li>

					</ul>
</li>

				<li class="li">Fetch the test results (optional: only required if the test run causes a
					timeout).
							<p class="p"><samp class="ph codeph">/sap/hana/testtools/unit/jasminexs/GetTestResults.xsjs</samp></p>
<p class="p">Fetches
						the test results for a given test-run ID. You an run this service multiple
						times for each test.</p>
<ul class="ul" id="loio3a19c328d2664d7d9297e9a12847e23a__ul_t3y_5ll_rp">
						<li class="li">Response:<p class="p"> Returns the test results in the requested format. If the
								tests are not yet finished, you receive a status message (either
										<span class="q">“<samp class="ph codeph">PREPARED</samp>”</span> or
										<span class="q">“<samp class="ph codeph">STARTED</samp>”</span>). If the run ID provided
								does not exist, an error message is displayed.</p>
</li>

						<li class="li">Parameters:<p class="p"><samp class="ph codeph">runid</samp>. Required for this kind of (manual)
								execution.</p>
<p class="p"><samp class="ph codeph">format</samp> (optional; default =
										<span class="q">“<samp class="ph codeph">html</samp>”</span>)</p>
</li>

					</ul>
</li>

			</ol>

		</div></div>

		<div class="section" id="loio3a19c328d2664d7d9297e9a12847e23a__section_kmk_svk_rp"><div class="section_title">Test Model Creation is Aborted</div><div type="Test Model Creation is Aborted">
			
			<p class="p">This error sometimes occurs if you try to create a copy of the original view and replace some
				dependencies with test tables. The reason for the error is one of the following:</p>

			<ul class="ul" id="loio3a19c328d2664d7d9297e9a12847e23a__ul_ts2_nml_rp">
				<li class="li">You did not provide any dependency substitutions. For example, you passed an
					empty array as the third parameter of
						<samp class="ph codeph">mockstar.createTestModel()</samp>).</li>

				<li class="li">The view that you want to test does not depend on any of the original views specified in the
					dependency substitutions.</li>

				<li class="li">For active schema mapping, you have written the dependencies with the
						<span class="ph emphasis emphasis">physical</span> schema whereas the view refers to the
						<span class="ph emphasis emphasis">authoring</span> schema. Provide the schema in the same way as
					it is written in the view (or stored procedure). </li>

			</ul>

		</div></div>

		<div class="section" id="loio3a19c328d2664d7d9297e9a12847e23a__section_tvk_vvk_rp"><div class="section_title">Database Connections in XSUnit Test</div><div type="Database Connections in XSUnit Test">
			
			<p class="p">The XSUnit test framework provides a new <span class="q">“managed”</span> database connection called
					<samp class="ph codeph">jasmine.dbConnection</samp>, which is automatically opened and rolled
				back (and closed) after each test completes. You can use it in
					<samp class="ph codeph">beforeEach</samp> or <samp class="ph codeph">afterEach</samp> functions, in other
				functions defined in your test libraries, or even in imported libraries, in the
				event that you have moved test code into external libraries. </p>

		</div></div>

	</div>

	<div class="related-links"> 
<div class="relinfo"><div class="relinfotitle ">Related Information</div>
<div><a class="link" href="default.html?433a6f176b6d490f9e39b7ac07dfec8c.html" target="_top" title="The XSUnit test framework is a custom version of the JavaScript test framework Jasmine adapted to suit SAP HANA XS.">Managed Database Connection Setup</a></div>
</div>
</div>
</div></div><div class="footer" id="custom-footer">
	<div id="custom-footerSpacer"><hr width="350px" align="left"/></div>
	<a class="copyright" href="copyright.html" target="_blank">Copyright</a><span class="separator"> | </span><a class="disclaimer" href="disclaimer.html" target="_blank">Important Disclaimers and Legal Information</a>
</div>

<SCRIPT LANGUAGE="JavaScript"><!--
 var page_title="XSUnit Troubleshooting Solutions";

        if (page_title !='' &&
        parent.document.title != null) {
 parent.document.title =
          page_title;
 } 
 var
        anchor = document.getElementById(location.hash.substring(+1)); if (typeof (anchor)
        !='undefined' && anchor !=null){
        var top = anchor.getBoundingClientRect().top; } 
//-->
</SCRIPT>
</body>
</html>