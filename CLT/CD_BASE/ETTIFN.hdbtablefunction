FUNCTION "OTEBW_TEST_CLT_CD"."CLT.CD_BASE::ETTIFN" ( )
RETURNS TABLE(
MANDT NVARCHAR(000003),ANLAGE NVARCHAR(000010),OPERAND NVARCHAR(000010),SAISON NVARCHAR(000010),AB NVARCHAR(000008),ABLFDNR NVARCHAR(000004),BIS NVARCHAR(000008),BELNR NVARCHAR(000012),MBELNR NVARCHAR(000012),MAUSZUG NVARCHAR(000001),ALTBIS NVARCHAR(000008),INAKTIV NVARCHAR(000001),MANAEND NVARCHAR(000001),TARIFART NVARCHAR(000008),KONDIGR NVARCHAR(000010),WERT1 DECIMAL(000016,000000),WERT2 DECIMAL(000016,000000),STRING1 NVARCHAR(000010),STRING2 NVARCHAR(000010),STRING3 NVARCHAR(000001),STRING4 NVARCHAR(000001),ERSATZWERT NVARCHAR(000001),BETRAG NVARCHAR(000013),WAERS NVARCHAR(000005),TT_FROM TIMESTAMP,TT_TO TIMESTAMP)
LANGUAGE SQLSCRIPT SQL SECURITY INVOKER AS BEGIN
RETURN SELECT MANDT,ANLAGE,OPERAND,SAISON,to_date(nullif(AB,'00000000'),'YYYYMMDD') as AB,ABLFDNR,to_date(nullif(BIS,'00000000'),'YYYYMMDD') as BIS,BELNR,MBELNR,MAUSZUG,to_date(nullif(ALTBIS,'00000000'),'YYYYMMDD') as ALTBIS,INAKTIV,MANAEND,TARIFART,KONDIGR,WERT1,WERT2,STRING1,STRING2,STRING3,STRING4,ERSATZWERT,BETRAG,WAERS,TST AS TT_FROM, "OTEBW_TEST_CLT_CD"."CLT.CD_BASE::ETTIFN_TRANSF_TT_TO"(MANDT,ANLAGE,OPERAND,SAISON,AB,ABLFDNR,TST) as TT_TO from "OTEBW_TEST_CLT_CD"."ETTIFN_CHG" where (not CLT_ACTION='D');
END;