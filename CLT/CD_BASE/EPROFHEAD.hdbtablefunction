FUNCTION "OTEBW_TEST_CLT_CD"."CLT.CD_BASE::EPROFHEAD" ( )
RETURNS TABLE(
MANDT NVARCHAR(000003),PROFILE NVARCHAR(000018),SPARTE NVARCHAR(000002),PROFTYPE NVARCHAR(000002),PROFVALCAT NVARCHAR(000002),VALUECUM NVARCHAR(000001),INTSIZEID NVARCHAR(000004),MASS NVARCHAR(000003),PROFDECIMALS NVARCHAR(000002),SOURCE NVARCHAR(000018),OBJNR NVARCHAR(000022),PROFOFFSET NVARCHAR(000006),CONCHECKGRP NVARCHAR(000010),FORWARD_ORIENTED NVARCHAR(000001),LASTVERSNO NVARCHAR(000006),DATEFROM NVARCHAR(000008),TIMEFROM NVARCHAR(000006),DATETO NVARCHAR(000008),TIMETO NVARCHAR(000006),ERDAT NVARCHAR(000008),ERNAM NVARCHAR(000012),AEDAT NVARCHAR(000008),AENAM NVARCHAR(000012),BEGRU NVARCHAR(000004),LOEVM NVARCHAR(000001),WAERS NVARCHAR(000005),ARCH_DATEFROM NVARCHAR(000008),ARCH_TIMEFROM NVARCHAR(000006),ARCH_DATETO NVARCHAR(000008),ARCH_TIMETO NVARCHAR(000006),REF_PROFILE NVARCHAR(000018),REPLACEMETHODGRP NVARCHAR(000010),DAY_OFFSET NVARCHAR(000006),TIME_ZONE NVARCHAR(000006),SRCPROFILE NVARCHAR(000018),MDUS_LOCATED NVARCHAR(000001),TOU_BILLABLE NVARCHAR(000001),TT_FROM TIMESTAMP,TT_TO TIMESTAMP)
LANGUAGE SQLSCRIPT SQL SECURITY INVOKER AS BEGIN
RETURN SELECT MANDT,PROFILE,SPARTE,PROFTYPE,PROFVALCAT,VALUECUM,INTSIZEID,MASS,PROFDECIMALS,SOURCE,OBJNR,to_time(nullif(PROFOFFSET,'000000'),'HHMMSS') as PROFOFFSET,CONCHECKGRP,FORWARD_ORIENTED,LASTVERSNO,to_date(nullif(DATEFROM,'00000000'),'YYYYMMDD') as DATEFROM,to_time(nullif(TIMEFROM,'000000'),'HHMMSS') as TIMEFROM,to_date(nullif(DATETO,'00000000'),'YYYYMMDD') as DATETO,to_time(nullif(TIMETO,'000000'),'HHMMSS') as TIMETO,to_date(nullif(ERDAT,'00000000'),'YYYYMMDD') as ERDAT,ERNAM,to_date(nullif(AEDAT,'00000000'),'YYYYMMDD') as AEDAT,AENAM,BEGRU,LOEVM,WAERS,to_date(nullif(ARCH_DATEFROM,'00000000'),'YYYYMMDD') as ARCH_DATEFROM,to_time(nullif(ARCH_TIMEFROM,'000000'),'HHMMSS') as ARCH_TIMEFROM,to_date(nullif(ARCH_DATETO,'00000000'),'YYYYMMDD') as ARCH_DATETO,to_time(nullif(ARCH_TIMETO,'000000'),'HHMMSS') as ARCH_TIMETO,REF_PROFILE,REPLACEMETHODGRP,to_time(nullif(DAY_OFFSET,'000000'),'HHMMSS') as DAY_OFFSET,TIME_ZONE,SRCPROFILE,MDUS_LOCATED,TOU_BILLABLE,TST AS TT_FROM, "OTEBW_TEST_CLT_CD"."CLT.CD_BASE::EPROFHEAD_TRANSF_TT_TO"(MANDT,PROFILE,TST) as TT_TO from "OTEBW_TEST_CLT_CD"."EPROFHEAD_CHG" where (not CLT_ACTION='D');
END;