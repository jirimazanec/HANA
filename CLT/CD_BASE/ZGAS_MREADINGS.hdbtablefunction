FUNCTION "OTEBW_TEST_CLT_CD"."CLT.CD_BASE::ZGAS_MREADINGS" ( )
RETURNS TABLE(
MANDT NVARCHAR(000003),MR_ID NVARCHAR(000020),ANLAGE NVARCHAR(000010),QUANTITY DECIMAL(000018,000000),QTY_STATUS NVARCHAR(000004),ENERGY DECIMAL(000018,000000),EN_STATUS NVARCHAR(000004),CALCULATED NVARCHAR(000001),ADAT NVARCHAR(000008),ATIM NVARCHAR(000006),ERDAT NVARCHAR(000008),ERTIM NVARCHAR(000006),LOEVM NVARCHAR(000001),DOCNUM NVARCHAR(000016),REASON NVARCHAR(000002),EADAT NVARCHAR(000008),AETIM NVARCHAR(000006),TT_FROM TIMESTAMP,TT_TO TIMESTAMP)
LANGUAGE SQLSCRIPT SQL SECURITY INVOKER AS BEGIN
RETURN SELECT MANDT,MR_ID,ANLAGE,QUANTITY,QTY_STATUS,ENERGY,EN_STATUS,CALCULATED,to_date(nullif(ADAT,'00000000'),'YYYYMMDD') as ADAT,to_time(nullif(ATIM,'000000'),'HHMMSS') as ATIM,to_date(nullif(ERDAT,'00000000'),'YYYYMMDD') as ERDAT,to_time(nullif(ERTIM,'000000'),'HHMMSS') as ERTIM,LOEVM,DOCNUM,REASON,to_date(nullif(EADAT,'00000000'),'YYYYMMDD') as EADAT,to_time(nullif(AETIM,'000000'),'HHMMSS') as AETIM,TST AS TT_FROM, "OTEBW_TEST_CLT_CD"."CLT.CD_BASE::ZGAS_MREADINGS_TRANSF_TT_TO"(MANDT,MR_ID,TST) as TT_TO from "OTEBW_TEST_CLT_CD"."ZGAS_MREADINGS_CHG" where (not CLT_ACTION='D');
END;