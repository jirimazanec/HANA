FUNCTION "OTEBW_TEST_CLT_CD"."CLT.CD_BASE::ESERVICE" ( )
RETURNS TABLE(
MANDT NVARCHAR(000003),VERTRAG NVARCHAR(000010),INT_UI NVARCHAR(000022),SERVICE_START NVARCHAR(000008),SERVICE_END NVARCHAR(000008),SERVICE NVARCHAR(000004),SERVICEID NVARCHAR(000010),SRVPRVREF NVARCHAR(000030),SERVPROV_PAY NVARCHAR(000004),SPARTE NVARCHAR(000002),STARTOBJTYPE NVARCHAR(000010),STARTOBJKEY NVARCHAR(000012),ENDOBJTYPE NVARCHAR(000010),ENDOBJKEY NVARCHAR(000012),ERDAT NVARCHAR(000008),ERNAM NVARCHAR(000012),AEDAT NVARCHAR(000008),AENAM NVARCHAR(000012),BEGRU NVARCHAR(000004),LOEVM NVARCHAR(000001),PREV_SERV_START NVARCHAR(000008),PREV_SERV_END NVARCHAR(000008),TT_FROM TIMESTAMP,TT_TO TIMESTAMP)
LANGUAGE SQLSCRIPT SQL SECURITY INVOKER AS BEGIN
RETURN SELECT MANDT,VERTRAG,INT_UI,to_date(nullif(SERVICE_START,'00000000'),'YYYYMMDD') as SERVICE_START,to_date(nullif(SERVICE_END,'00000000'),'YYYYMMDD') as SERVICE_END,SERVICE,SERVICEID,SRVPRVREF,SERVPROV_PAY,SPARTE,STARTOBJTYPE,STARTOBJKEY,ENDOBJTYPE,ENDOBJKEY,to_date(nullif(ERDAT,'00000000'),'YYYYMMDD') as ERDAT,ERNAM,to_date(nullif(AEDAT,'00000000'),'YYYYMMDD') as AEDAT,AENAM,BEGRU,LOEVM,to_date(nullif(PREV_SERV_START,'00000000'),'YYYYMMDD') as PREV_SERV_START,to_date(nullif(PREV_SERV_END,'00000000'),'YYYYMMDD') as PREV_SERV_END,TST AS TT_FROM, "OTEBW_TEST_CLT_CD"."CLT.CD_BASE::ESERVICE_TRANSF_TT_TO"(MANDT,VERTRAG,TST) as TT_TO from "OTEBW_TEST_CLT_CD"."ESERVICE_CHG" where (not CLT_ACTION='D');
END;